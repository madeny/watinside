<script>
  (function(){
    const btn = document.getElementById('menu-toggle');
    const menu = document.getElementById('mobile-menu');
    if (!btn || !menu) return;

    const closeMenu = () => menu.classList.add('hidden');
    const toggleMenu = () => menu.classList.toggle('hidden');

    btn.addEventListener('click', (e) => {
      e.stopPropagation();
      toggleMenu();
    });

    // Click outside the panel (on the dark overlay) closes it
    menu.addEventListener('click', (e) => {
      if (e.target === menu) closeMenu();
    });

    // Clicking any link closes the menu
    menu.querySelectorAll('a').forEach(a => a.addEventListener('click', closeMenu));

    // Escape to close
    document.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeMenu(); });

    // Close if resizing to desktop
    const mql = window.matchMedia('(min-width: 768px)');
    if (mql && mql.addEventListener) {
      mql.addEventListener('change', (e) => { if (e.matches) closeMenu(); });
    }
  })();
</script>
